name: test

on:
  schedule:
    - cron:  '12 12 13 12 5'
  workflow_dispatch:
    inputs:
      models:
        description: "Models to run eg: test+ +test1 +test2+" 
        required: true
      environment:
        description: 'Prod'
        type: boolean
      full_refresh:
        description: 'full-refresh'
        type: boolean
      
      
  pull_request:
    branches:
      - main
    types: [opened,closed,edited, synchronize, reopened]

env:
  test: "test1"
  test2: "test2"
  test3: 1

jobs:
  scheduled_run:
    name: scheduled_run
    runs-on: ubuntu-latest

    steps:
      - name: test workflow dispatch
        if: github.event_name == 'workflow_dispatch' && ${{ env.test3 }} > 0 
        env: 
          test: "changed test"
        run: |
          
          echo "condition works"
      
    # echo "dbt run testmodel ${{ fromJSON('["","--target prod"]')[github.event.inputs.bq_environment == 'true'] }}"
    # - name: checkout
    #   uses: actions/checkout@v2
    #   with:
    #     fetch-depth: 0
    
    # - name: log
    #   if: github.event.pull_request.merged == false
    #   run: |
    #     echo "${{ github.event.pull_request }}"

    # - name: run_models_test
    #   if: github.event.pull_request.merged == false
    #   run: |
    #     echo "NOT MERGED"
    
    # - name: run_models_prod
    #   if: github.event.pull_request.merged == true
    #   run: |
    #     echo "MERGED"
    #run: echo "${{ github.event.inputs.message }} ${{ fromJSON('["", "ðŸ¥³"]')[github.event.inputs.use-emoji == 'true'] }} ${{ github.event.inputs.name }}"



      - name: merge prod
        if: github.event_name == 'pull_request' &&  github.event.pull_request.merged == true
        run: |
          echo "prod"


          
          
      